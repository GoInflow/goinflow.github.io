define(["ko","jquery","underscore"],function(s,n,o){"use strict";var i=["undefined","boolean","number","string"];function r(t,n,i){for(var e=n.pop(),r=n.length,s=0,u=n[s];s<r;u=n[++s])o.isObject(t[u])||(t[u]={}),t=t[u];return"function"==typeof t[e]?t[e](i):t[e]=i,i}function e(t,n){for(var i=!0,e=n.length,r=0;r<e&&i;r++)void 0===(t=t[n[r]])&&(i=!1);if(i)return s.isObservable(t)&&(t=t()),t}return{nested:function(t,n,i){return(2<arguments.length?r:e)(t,n=n?n.split("."):[],i)},nestedRemove:function(t,n){!function(t,n){var i=n.pop();t=e(t,n),o.isObject(t)&&delete t[i]}(t,n=n.split("."))},flatten:function(t,i,e,r){return i=i||".",r=r||{},o.each(t,function(t,n){e&&(n=e+i+n),"object"==typeof t?this.flatten(t,i,n,r):r[n]=t},this),r},unflatten:function(t,i){var e={};return i=i||".",o.each(t,function(t,n){n=n.split(i),r(e,n,t)}),e},serialize:function(t){var i={};return t=this.flatten(t),o.each(t,function(t,n){n=this.serializeName(n),t=o.isUndefined(t)?"":t,i[n]=t},this),i},extend:function(){var t=o.toArray(arguments);return t.unshift(!0),n.extend.apply(n,t)},copy:function(t){var n,i=t,e=Array.isArray(t);return(this.isObject(t)||e)&&(n=e?[]:{},i=this.extend(n,t)),i},hardCopy:function(t){return null===t||"object"!=typeof t?t:JSON.parse(JSON.stringify(t))},omit:function(i,t){var e={},r=t;return this.isObject(t)?(r=[],o.each(t,function(t,n){t&&r.push(n)})):o.isString(t)&&(r=o.toArray(arguments).slice(1)),o.each(r,function(t){var n=this.nested(i,t);o.isUndefined(n)||(e[t]=n,this.nestedRemove(i,t))},this),e},isObject:function(t){var n=Object.prototype;return"object"==typeof t&&"[object Object]"===n.toString.call(t)},isPrimitive:function(t){return null===t||~i.indexOf(typeof t)},forEachRecursive:function(t,n,i){i="number"!=typeof i||isNaN(i)?7:i-1,!o.isFunction(n)||o.isFunction(t)||i<0||(o.isObject(t)&&o.each(t,function(t){this.forEachRecursive(t,n,i)},this),n(t))},mapRecursive:function(i,e,r){var t;return r="number"!=typeof r||isNaN(r)?7:r-1,!o.isFunction(e)||o.isFunction(i)||r<0?i:o.isObject(i)?(t=o.isArray(i)?o.map(i,function(t){return this.mapRecursive(t,e,r)},this):o.mapObject(i,function(t,n){return i.hasOwnProperty(n)?this.mapRecursive(t,e,r):t},this),e(t)):e(i)},removeEmptyValues:function(t){return o.isObject(t)?o.isArray(t)?t.filter(function(t){return!this.isEmptyObj(t)},this):o.omit(t,this.isEmptyObj.bind(this)):t},isEmptyObj:function(t){return o.isObject(t)&&o.isEmpty(t)||this.isEmpty(t)||t&&t.trim&&this.isEmpty(t.trim())}}});
