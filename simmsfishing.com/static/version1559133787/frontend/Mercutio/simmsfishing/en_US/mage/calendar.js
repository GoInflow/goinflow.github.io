!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery/ui","jquery/jquery-ui-timepicker-addon"],t):t(window.jQuery)}(function(tt){"use strict";var t,e=tt.datepicker.constructor.prototype;return tt.datepicker.markerClassName="_has-datepicker",tt.extend(e,{_getTimezoneDate:function(t){var e=Date.now();return void 0!==(t=t||tt.calendarConfig||{}).serverTimezoneOffset?e+=60*(new Date).getTimezoneOffset()*1e3+1e3*t.serverTimezoneOffset:void 0!==t.serverTimezoneSeconds&&(e=1e3*(t.serverTimezoneSeconds+60*(new Date).getTimezoneOffset())),new Date(e)},_setTimezoneDateDatepicker:function(t){this._setDateDatepicker(t,this._getTimezoneDate())}}),tt.widget("mage.calendar",{_create:function(){this._enableAMPM(),this.options=tt.extend({},tt.calendarConfig?tt.calendarConfig:{},this.options.showsTime?{showTime:!0,showHour:!0,showMinute:!0}:{},this.options),this._initPicker(this.element),this._overwriteGenerateHtml()},_picker:function(){return this.options.showsTime?"datetimepicker":"datepicker"},_enableAMPM:function(){this.options.timeFormat&&0<=this.options.timeFormat.indexOf("tt")&&(this.options.ampm=!0)},_overwriteGenerateHtml:function(){tt.datepicker.constructor.prototype._generateHTML=function(t){var e,i,a,s,n,r,o,c,h,d,l,u,p,g,m,_,f,k,y,D=this._getTimezoneDate(),w=this._get(t,"isRTL"),v=this._get(t,"showButtonPanel"),M=this._get(t,"hideIfNoPrevNext"),T=this._get(t,"navigationAsDateFormat"),x=this._getNumberOfMonths(t),b=this._get(t,"showCurrentAtPos"),F=this._get(t,"stepMonths"),j=1!==parseInt(x[0],10)||1!==parseInt(x[1],10),z=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),C=this._getMinMaxDate(t,"min"),A=this._getMinMaxDate(t,"max"),S=t.drawMonth-b,O=t.drawYear,E=this._get(t,"prevText"),N=this._get(t,"nextText"),P=this._get(t,"currentText"),Y=this._get(t,"showWeek"),R=this._get(t,"dayNames"),I=this._get(t,"dayNamesMin"),H=this._get(t,"monthNames"),q=this._get(t,"monthNamesShort"),G=this._get(t,"beforeShowDay"),L=this._get(t,"showOtherMonths"),W=this._get(t,"selectOtherMonths"),B=this._getDefaultDate(t),Q="",J=0,K=0,U=" ui-corner-all",V="",X="",Z=0,$=0;if(S<0&&(S+=12,O--),A)for(e=this._daylightSavingAdjust(new Date(A.getFullYear(),A.getMonth()-x[0]*x[1]+1,A.getDate())),e=C&&e<C?C:e;this._daylightSavingAdjust(new Date(O,S,1))>e;)--S<0&&(S=11,O--);for(t.drawMonth=S,t.drawYear=O,E=T?this.formatDate(E,this._daylightSavingAdjust(new Date(O,S-F,1)),this._getFormatConfig(t)):E,i=this._canAdjustMonth(t,-1,O,S)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+E+'"><span class="ui-icon ui-icon-circle-triangle-'+(w?"e":"w")+'">'+E+"</span></a>":M?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+E+'"><span class="ui-icon ui-icon-circle-triangle-'+(w?"e":"w")+'">'+E+"</span></a>",N=T?this.formatDate(N,this._daylightSavingAdjust(new Date(O,S+F,1)),this._getFormatConfig(t)):N,a=this._canAdjustMonth(t,1,O,S)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click"title="'+N+'"><span class="ui-icon ui-icon-circle-triangle-'+(w?"w":"e")+'">'+N+"</span></a>":M?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+N+'"><span class="ui-icon ui-icon-circle-triangle-'+(w?"w":"e")+'">'+N+"</span></a>",s=this._get(t,"gotoCurrent")&&t.currentDay?z:D,P=T?this.formatDate(P,s,this._getFormatConfig(t)):P,n=t.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(t,"closeText")+"</button>",r=v?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(w?n:"")+(this._isInRange(t,s)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+P+"</button>":"")+(w?"":n)+"</div>":"",o=parseInt(this._get(t,"firstDay"),10),o=isNaN(o)?0:o;J<x[0];J++){for(this.maxRows=4;K<x[1];K++){if(c=this._daylightSavingAdjust(new Date(O,S,t.selectedDay)),j){if(X+='<div class="ui-datepicker-group',1<x[1])switch(K){case 0:X+=" ui-datepicker-group-first",U=" ui-corner-"+(w?"right":"left");break;case x[1]-1:X+=" ui-datepicker-group-last",U=" ui-corner-"+(w?"left":"right");break;default:X+=" ui-datepicker-group-middle",U=""}X+='">'}for(X+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+U+'">'+(/all|left/.test(U)&&0===parseInt(J,10)?w?a:i:"")+(/all|right/.test(U)&&0===parseInt(J,10)?w?i:a:"")+this._generateMonthYearHeader(t,S,O,C,A,0<J||0<K,H,q)+'</div><table class="ui-datepicker-calendar"><thead><tr>',h=Y?'<th class="ui-datepicker-week-col">'+this._get(t,"weekHeader")+"</th>":"";Z<7;Z++)h+="<th"+(5<=(Z+o+6)%7?' class="ui-datepicker-week-end"':"")+'><span title="'+R[d=(Z+o)%7]+'">'+I[d]+"</span></th>";for(X+=h+"</tr></thead><tbody>",l=this._getDaysInMonth(O,S),O===t.selectedYear&&S===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,l)),u=(this._getFirstDayOfMonth(O,S)-o+7)%7,p=Math.ceil((u+l)/7),g=j&&this.maxRows>p?this.maxRows:p,this.maxRows=g,m=this._daylightSavingAdjust(new Date(O,S,1-u));$<g;$++){for(X+="<tr>",_=Y?'<td class="ui-datepicker-week-col">'+this._get(t,"calculateWeek")(m)+"</td>":"",Z=0;Z<7;Z++)f=G?G.apply(t.input?t.input[0]:null,[m]):[!0,""],y=(k=m.getMonth()!==S)&&!W||!f[0]||C&&m<C||A&&A<m,_+='<td class="'+(5<=(Z+o+6)%7?" ui-datepicker-week-end":"")+(k?" ui-datepicker-other-month":"")+(m.getTime()===c.getTime()&&S===t.selectedMonth&&t._keyEvent||B.getTime()===m.getTime()&&B.getTime()===c.getTime()?" "+this._dayOverClass:"")+(y?" "+this._unselectableClass+" ui-state-disabled":"")+(k&&!L?"":" "+f[1]+(m.getTime()===z.getTime()?" "+this._currentClass:"")+(m.getDate()===D.getDate()&&m.getMonth()===D.getMonth()&&m.getYear()===D.getYear()?" ui-datepicker-today":""))+'"'+(k&&!L||!f[2]?"":' title="'+f[2]+'"')+(y?"":' data-handler="selectDay" data-event="click" data-month="'+m.getMonth()+'" data-year="'+m.getFullYear()+'"')+">"+(k&&!L?"&#xa0;":y?'<span class="ui-state-default">'+m.getDate()+"</span>":'<a class="ui-state-default'+(m.getTime()===D.getTime()?" ":"")+(m.getTime()===z.getTime()?" ui-state-active":"")+(k?" ui-priority-secondary":"")+'" href="#">'+m.getDate()+"</a>")+"</td>",m.setDate(m.getDate()+1),m=this._daylightSavingAdjust(m);X+=_+"</tr>"}11<++S&&(S=0,O++),V+=X+="</tbody></table>"+(j?"</div>"+(0<x[0]&&K===x[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"")}Q+=V}return Q+=r+(tt.ui.ie6&&!t.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),t._keyEvent=!1,Q}},_setCurrentDate:function(t){t.val()||t[this._picker()]("setTimezoneDate").val("")},_initPicker:function(t){var e=t[this._picker()](this.options),i=e.next(".ui-datepicker-trigger").find("img").attr("title");e.next(".ui-datepicker-trigger").addClass("v-middle").text("").append("<span>"+i+"</span>"),this._setCurrentDate(t)},_destroy:function(){this.element[this._picker()]("destroy"),this._super()},getTimezoneDate:function(){return e._getTimezoneDate.call(this,this.options)}}),t=tt.mage.calendar.prototype,tt.widget("mage.calendar",tt.extend({},t,{dateTimeFormat:{date:{EEEE:"DD",EEE:"D",EE:"D",E:"D",D:"o",MMMM:"MM",MMM:"M",MM:"mm",M:"mm",yyyy:"yy",y:"yy",Y:"yy",yy:"yy"},time:{a:"TT"}},_create:function(){this.options.dateFormat&&(this.options.dateFormat=this._convertFormat(this.options.dateFormat,"date")),this.options.timeFormat&&(this.options.timeFormat=this._convertFormat(this.options.timeFormat,"time")),t._create.apply(this,arguments)},_convertFormat:function(t,i){var e=t.match(/([a-z]+)/gi),a=t.match(/([^a-z]+)/gi),s=this,n="";return e&&tt.each(e,function(t,e){n+=(s.dateTimeFormat[i][e]||e)+(a[t]||"")}),n}})),tt.widget("mage.dateRange",tt.mage.calendar,{_initPicker:function(){var e,i;this.options.from&&this.options.to&&(e=this.element.find("#"+this.options.from.id),i=this.element.find("#"+this.options.to.id),this.options.onSelect=tt.proxy(function(t){i[this._picker()]("option","minDate",t)},this),tt.mage.calendar.prototype._initPicker.call(this,e),e.on("change",tt.proxy(function(){i[this._picker()]("option","minDate",e[this._picker()]("getDate"))},this)),this.options.onSelect=tt.proxy(function(t){e[this._picker()]("option","maxDate",t)},this),tt.mage.calendar.prototype._initPicker.call(this,i),i.on("change",tt.proxy(function(){e[this._picker()]("option","maxDate",i[this._picker()]("getDate"))},this)))},_destroy:function(){this.options.from&&this.element.find("#"+this.options.from.id)[this._picker()]("destroy"),this.options.to&&this.element.find("#"+this.options.to.id)[this._picker()]("destroy"),this._super()}}),tt.datepicker._gotoTodayOriginal=tt.datepicker._gotoToday,tt.datepicker._showDatepickerOriginal=tt.datepicker._showDatepicker,tt.datepicker._showDatepicker=function(t){t.disabled||tt.datepicker._showDatepickerOriginal.call(this,t)},tt.datepicker._gotoToday=function(t){tt(t).datepicker("setTimezoneDate").blur()},{dateRange:tt.mage.dateRange,calendar:tt.mage.calendar}});
